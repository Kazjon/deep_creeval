import pymongo, argparse, csv, sys, os
from pymongo import MongoClient
from pylearn2.datasets.dense_design_matrix import DenseDesignMatrix
import numpy as np
import cPickle as pickle

#checklist_metadata = [u'ASTER2011_DEM', u'CAUS_FIRST_AUTUMN_32F_EXTREME', u'CAUS_FIRST_AUTUMN_32F_MEAN', u'CAUS_FIRST_AUTUMN_32F_MEDIAN', u'CAUS_LAST_SPRING_32F_EXTREME', u'CAUS_LAST_SPRING_32F_MEAN', u'CAUS_LAST_SPRING_32F_MEDIAN', u'CAUS_PREC', u'CAUS_PREC01', u'CAUS_PREC02', u'CAUS_PREC03', u'CAUS_PREC04', u'CAUS_PREC05', u'CAUS_PREC06', u'CAUS_PREC07', u'CAUS_PREC08', u'CAUS_PREC09', u'CAUS_PREC10', u'CAUS_PREC11', u'CAUS_PREC12', u'CAUS_PREC13', u'CAUS_SNOW', u'CAUS_SNOW01', u'CAUS_SNOW02', u'CAUS_SNOW03', u'CAUS_SNOW04', u'CAUS_SNOW10', u'CAUS_SNOW11', u'CAUS_SNOW12', u'CAUS_TEMP_AVG', u'CAUS_TEMP_AVG01', u'CAUS_TEMP_AVG02', u'CAUS_TEMP_AVG03', u'CAUS_TEMP_AVG04', u'CAUS_TEMP_AVG05', u'CAUS_TEMP_AVG06', u'CAUS_TEMP_AVG07', u'CAUS_TEMP_AVG08', u'CAUS_TEMP_AVG09', u'CAUS_TEMP_AVG10', u'CAUS_TEMP_AVG11', u'CAUS_TEMP_AVG12', u'CAUS_TEMP_AVG13', u'CAUS_TEMP_MAX', u'CAUS_TEMP_MAX01', u'CAUS_TEMP_MAX02', u'CAUS_TEMP_MAX03', u'CAUS_TEMP_MAX04', u'CAUS_TEMP_MAX05', u'CAUS_TEMP_MAX06', u'CAUS_TEMP_MAX07', u'CAUS_TEMP_MAX08', u'CAUS_TEMP_MAX09', u'CAUS_TEMP_MAX10', u'CAUS_TEMP_MAX11', u'CAUS_TEMP_MAX12', u'CAUS_TEMP_MAX13', u'CAUS_TEMP_MIN', u'CAUS_TEMP_MIN01', u'CAUS_TEMP_MIN02', u'CAUS_TEMP_MIN03', u'CAUS_TEMP_MIN04', u'CAUS_TEMP_MIN05', u'CAUS_TEMP_MIN06', u'CAUS_TEMP_MIN07', u'CAUS_TEMP_MIN08', u'CAUS_TEMP_MIN09', u'CAUS_TEMP_MIN10', u'CAUS_TEMP_MIN11', u'CAUS_TEMP_MIN12', u'CAUS_TEMP_MIN13', u'DAY', u'DIST_FROM_FLOWING_BRACKISH', u'DIST_FROM_FLOWING_FRESH', u'DIST_FROM_STANDING_BRACKISH', u'DIST_FROM_STANDING_FRESH', u'DIST_FROM_WET_VEG_BRACKISH', u'DIST_FROM_WET_VEG_FRESH', u'DIST_IN_FLOWING_BRACKISH', u'DIST_IN_FLOWING_FRESH', u'DIST_IN_STANDING_BRACKISH', u'DIST_IN_STANDING_FRESH', u'DIST_IN_WET_VEG_BRACKISH', u'DIST_IN_WET_VEG_FRESH', u'EFFORT_AREA_HA', u'EFFORT_DISTANCE_KM', u'EFFORT_HRS', u'ELEV_GT', u'ELEV_NED', u'HOUSING_DENSITY', u'HOUSING_PERCENT_VACANT', u'LATITUDE', u'LONGITUDE', u'NLCD01_CANOPYMEAN_RAD75', u'NLCD01_CANOPYMEAN_RAD750', u'NLCD01_CANOPYMEAN_RAD7500', u'NLCD01_IMPERVMEAN_RAD75', u'NLCD01_IMPERVMEAN_RAD750', u'NLCD01_IMPERVMEAN_RAD7500', u'NLCD2001_FS_C11_7500_ED', u'NLCD2001_FS_C11_7500_LPI', u'NLCD2001_FS_C11_7500_PD', u'NLCD2001_FS_C11_7500_PLAND', u'NLCD2001_FS_C11_750_ED', u'NLCD2001_FS_C11_750_LPI', u'NLCD2001_FS_C11_750_PD', u'NLCD2001_FS_C11_750_PLAND', u'NLCD2001_FS_C11_75_ED', u'NLCD2001_FS_C11_75_LPI', u'NLCD2001_FS_C11_75_PD', u'NLCD2001_FS_C11_75_PLAND', u'NLCD2001_FS_C12_7500_ED', u'NLCD2001_FS_C12_7500_LPI', u'NLCD2001_FS_C12_7500_PD', u'NLCD2001_FS_C12_7500_PLAND', u'NLCD2001_FS_C12_750_ED', u'NLCD2001_FS_C12_750_LPI', u'NLCD2001_FS_C12_750_PD', u'NLCD2001_FS_C12_750_PLAND', u'NLCD2001_FS_C12_75_ED', u'NLCD2001_FS_C12_75_LPI', u'NLCD2001_FS_C12_75_PD', u'NLCD2001_FS_C12_75_PLAND', u'NLCD2001_FS_C21_7500_ED', u'NLCD2001_FS_C21_7500_LPI', u'NLCD2001_FS_C21_7500_PD', u'NLCD2001_FS_C21_7500_PLAND', u'NLCD2001_FS_C21_750_ED', u'NLCD2001_FS_C21_750_LPI', u'NLCD2001_FS_C21_750_PD', u'NLCD2001_FS_C21_750_PLAND', u'NLCD2001_FS_C21_75_ED', u'NLCD2001_FS_C21_75_LPI', u'NLCD2001_FS_C21_75_PD', u'NLCD2001_FS_C21_75_PLAND', u'NLCD2001_FS_C22_7500_ED', u'NLCD2001_FS_C22_7500_LPI', u'NLCD2001_FS_C22_7500_PD', u'NLCD2001_FS_C22_7500_PLAND', u'NLCD2001_FS_C22_750_ED', u'NLCD2001_FS_C22_750_LPI', u'NLCD2001_FS_C22_750_PD', u'NLCD2001_FS_C22_750_PLAND', u'NLCD2001_FS_C22_75_ED', u'NLCD2001_FS_C22_75_LPI', u'NLCD2001_FS_C22_75_PD', u'NLCD2001_FS_C22_75_PLAND', u'NLCD2001_FS_C23_7500_ED', u'NLCD2001_FS_C23_7500_LPI', u'NLCD2001_FS_C23_7500_PD', u'NLCD2001_FS_C23_7500_PLAND', u'NLCD2001_FS_C23_750_ED', u'NLCD2001_FS_C23_750_LPI', u'NLCD2001_FS_C23_750_PD', u'NLCD2001_FS_C23_750_PLAND', u'NLCD2001_FS_C23_75_ED', u'NLCD2001_FS_C23_75_LPI', u'NLCD2001_FS_C23_75_PD', u'NLCD2001_FS_C23_75_PLAND', u'NLCD2001_FS_C24_7500_ED', u'NLCD2001_FS_C24_7500_LPI', u'NLCD2001_FS_C24_7500_PD', u'NLCD2001_FS_C24_7500_PLAND', u'NLCD2001_FS_C24_750_ED', u'NLCD2001_FS_C24_750_LPI', u'NLCD2001_FS_C24_750_PD', u'NLCD2001_FS_C24_750_PLAND', u'NLCD2001_FS_C24_75_ED', u'NLCD2001_FS_C24_75_LPI', u'NLCD2001_FS_C24_75_PD', u'NLCD2001_FS_C24_75_PLAND', u'NLCD2001_FS_C31_7500_ED', u'NLCD2001_FS_C31_7500_LPI', u'NLCD2001_FS_C31_7500_PD', u'NLCD2001_FS_C31_7500_PLAND', u'NLCD2001_FS_C31_750_ED', u'NLCD2001_FS_C31_750_LPI', u'NLCD2001_FS_C31_750_PD', u'NLCD2001_FS_C31_750_PLAND', u'NLCD2001_FS_C31_75_ED', u'NLCD2001_FS_C31_75_LPI', u'NLCD2001_FS_C31_75_PD', u'NLCD2001_FS_C31_75_PLAND', u'NLCD2001_FS_C41_7500_ED', u'NLCD2001_FS_C41_7500_LPI', u'NLCD2001_FS_C41_7500_PD', u'NLCD2001_FS_C41_7500_PLAND', u'NLCD2001_FS_C41_750_ED', u'NLCD2001_FS_C41_750_LPI', u'NLCD2001_FS_C41_750_PD', u'NLCD2001_FS_C41_750_PLAND', u'NLCD2001_FS_C41_75_ED', u'NLCD2001_FS_C41_75_LPI', u'NLCD2001_FS_C41_75_PD', u'NLCD2001_FS_C41_75_PLAND', u'NLCD2001_FS_C42_7500_ED', u'NLCD2001_FS_C42_7500_LPI', u'NLCD2001_FS_C42_7500_PD', u'NLCD2001_FS_C42_7500_PLAND', u'NLCD2001_FS_C42_750_ED', u'NLCD2001_FS_C42_750_LPI', u'NLCD2001_FS_C42_750_PD', u'NLCD2001_FS_C42_750_PLAND', u'NLCD2001_FS_C42_75_ED', u'NLCD2001_FS_C42_75_LPI', u'NLCD2001_FS_C42_75_PD', u'NLCD2001_FS_C42_75_PLAND', u'NLCD2001_FS_C43_7500_ED', u'NLCD2001_FS_C43_7500_LPI', u'NLCD2001_FS_C43_7500_PD', u'NLCD2001_FS_C43_7500_PLAND', u'NLCD2001_FS_C43_750_ED', u'NLCD2001_FS_C43_750_LPI', u'NLCD2001_FS_C43_750_PD', u'NLCD2001_FS_C43_750_PLAND', u'NLCD2001_FS_C43_75_ED', u'NLCD2001_FS_C43_75_LPI', u'NLCD2001_FS_C43_75_PD', u'NLCD2001_FS_C43_75_PLAND', u'NLCD2001_FS_C52_7500_ED', u'NLCD2001_FS_C52_7500_LPI', u'NLCD2001_FS_C52_7500_PD', u'NLCD2001_FS_C52_7500_PLAND', u'NLCD2001_FS_C52_750_ED', u'NLCD2001_FS_C52_750_LPI', u'NLCD2001_FS_C52_750_PD', u'NLCD2001_FS_C52_750_PLAND', u'NLCD2001_FS_C52_75_ED', u'NLCD2001_FS_C52_75_LPI', u'NLCD2001_FS_C52_75_PD', u'NLCD2001_FS_C52_75_PLAND', u'NLCD2001_FS_C71_7500_ED', u'NLCD2001_FS_C71_7500_LPI', u'NLCD2001_FS_C71_7500_PD', u'NLCD2001_FS_C71_7500_PLAND', u'NLCD2001_FS_C71_750_ED', u'NLCD2001_FS_C71_750_LPI', u'NLCD2001_FS_C71_750_PD', u'NLCD2001_FS_C71_750_PLAND', u'NLCD2001_FS_C71_75_ED', u'NLCD2001_FS_C71_75_LPI', u'NLCD2001_FS_C71_75_PD', u'NLCD2001_FS_C71_75_PLAND', u'NLCD2001_FS_C81_7500_ED', u'NLCD2001_FS_C81_7500_LPI', u'NLCD2001_FS_C81_7500_PD', u'NLCD2001_FS_C81_7500_PLAND', u'NLCD2001_FS_C81_750_ED', u'NLCD2001_FS_C81_750_LPI', u'NLCD2001_FS_C81_750_PD', u'NLCD2001_FS_C81_750_PLAND', u'NLCD2001_FS_C81_75_ED', u'NLCD2001_FS_C81_75_LPI', u'NLCD2001_FS_C81_75_PD', u'NLCD2001_FS_C81_75_PLAND', u'NLCD2001_FS_C82_7500_ED', u'NLCD2001_FS_C82_7500_LPI', u'NLCD2001_FS_C82_7500_PD', u'NLCD2001_FS_C82_7500_PLAND', u'NLCD2001_FS_C82_750_ED', u'NLCD2001_FS_C82_750_LPI', u'NLCD2001_FS_C82_750_PD', u'NLCD2001_FS_C82_750_PLAND', u'NLCD2001_FS_C82_75_ED', u'NLCD2001_FS_C82_75_LPI', u'NLCD2001_FS_C82_75_PD', u'NLCD2001_FS_C82_75_PLAND', u'NLCD2001_FS_C90_7500_ED', u'NLCD2001_FS_C90_7500_LPI', u'NLCD2001_FS_C90_7500_PD', u'NLCD2001_FS_C90_7500_PLAND', u'NLCD2001_FS_C90_750_ED', u'NLCD2001_FS_C90_750_LPI', u'NLCD2001_FS_C90_750_PD', u'NLCD2001_FS_C90_750_PLAND', u'NLCD2001_FS_C90_75_ED', u'NLCD2001_FS_C90_75_LPI', u'NLCD2001_FS_C90_75_PD', u'NLCD2001_FS_C90_75_PLAND', u'NLCD2001_FS_C95_7500_ED', u'NLCD2001_FS_C95_7500_LPI', u'NLCD2001_FS_C95_7500_PD', u'NLCD2001_FS_C95_7500_PLAND', u'NLCD2001_FS_C95_750_ED', u'NLCD2001_FS_C95_750_LPI', u'NLCD2001_FS_C95_750_PD', u'NLCD2001_FS_C95_750_PLAND', u'NLCD2001_FS_C95_75_ED', u'NLCD2001_FS_C95_75_LPI', u'NLCD2001_FS_C95_75_PD', u'NLCD2001_FS_C95_75_PLAND', u'NLCD2001_FS_L_7500_ED', u'NLCD2001_FS_L_7500_LPI', u'NLCD2001_FS_L_7500_PD', u'NLCD2001_FS_L_750_ED', u'NLCD2001_FS_L_750_LPI', u'NLCD2001_FS_L_750_PD', u'NLCD2001_FS_L_75_ED', u'NLCD2001_FS_L_75_LPI', u'NLCD2001_FS_L_75_PD', u'NLCD2006_FS_C11_7500_ED', u'NLCD2006_FS_C11_7500_LPI', u'NLCD2006_FS_C11_7500_PD', u'NLCD2006_FS_C11_7500_PLAND', u'NLCD2006_FS_C11_750_ED', u'NLCD2006_FS_C11_750_LPI', u'NLCD2006_FS_C11_750_PD', u'NLCD2006_FS_C11_750_PLAND', u'NLCD2006_FS_C11_75_ED', u'NLCD2006_FS_C11_75_LPI', u'NLCD2006_FS_C11_75_PD', u'NLCD2006_FS_C11_75_PLAND', u'NLCD2006_FS_C12_7500_ED', u'NLCD2006_FS_C12_7500_LPI', u'NLCD2006_FS_C12_7500_PD', u'NLCD2006_FS_C12_7500_PLAND', u'NLCD2006_FS_C12_750_ED', u'NLCD2006_FS_C12_750_LPI', u'NLCD2006_FS_C12_750_PD', u'NLCD2006_FS_C12_750_PLAND', u'NLCD2006_FS_C12_75_ED', u'NLCD2006_FS_C12_75_LPI', u'NLCD2006_FS_C12_75_PD', u'NLCD2006_FS_C12_75_PLAND', u'NLCD2006_FS_C21_7500_ED', u'NLCD2006_FS_C21_7500_LPI', u'NLCD2006_FS_C21_7500_PD', u'NLCD2006_FS_C21_7500_PLAND', u'NLCD2006_FS_C21_750_ED', u'NLCD2006_FS_C21_750_LPI', u'NLCD2006_FS_C21_750_PD', u'NLCD2006_FS_C21_750_PLAND', u'NLCD2006_FS_C21_75_ED', u'NLCD2006_FS_C21_75_LPI', u'NLCD2006_FS_C21_75_PD', u'NLCD2006_FS_C21_75_PLAND', u'NLCD2006_FS_C22_7500_ED', u'NLCD2006_FS_C22_7500_LPI', u'NLCD2006_FS_C22_7500_PD', u'NLCD2006_FS_C22_7500_PLAND', u'NLCD2006_FS_C22_750_ED', u'NLCD2006_FS_C22_750_LPI', u'NLCD2006_FS_C22_750_PD', u'NLCD2006_FS_C22_750_PLAND', u'NLCD2006_FS_C22_75_ED', u'NLCD2006_FS_C22_75_LPI', u'NLCD2006_FS_C22_75_PD', u'NLCD2006_FS_C22_75_PLAND', u'NLCD2006_FS_C23_7500_ED', u'NLCD2006_FS_C23_7500_LPI', u'NLCD2006_FS_C23_7500_PD', u'NLCD2006_FS_C23_7500_PLAND', u'NLCD2006_FS_C23_750_ED', u'NLCD2006_FS_C23_750_LPI', u'NLCD2006_FS_C23_750_PD', u'NLCD2006_FS_C23_750_PLAND', u'NLCD2006_FS_C23_75_ED', u'NLCD2006_FS_C23_75_LPI', u'NLCD2006_FS_C23_75_PD', u'NLCD2006_FS_C23_75_PLAND', u'NLCD2006_FS_C24_7500_ED', u'NLCD2006_FS_C24_7500_LPI', u'NLCD2006_FS_C24_7500_PD', u'NLCD2006_FS_C24_7500_PLAND', u'NLCD2006_FS_C24_750_ED', u'NLCD2006_FS_C24_750_LPI', u'NLCD2006_FS_C24_750_PD', u'NLCD2006_FS_C24_750_PLAND', u'NLCD2006_FS_C24_75_ED', u'NLCD2006_FS_C24_75_LPI', u'NLCD2006_FS_C24_75_PD', u'NLCD2006_FS_C24_75_PLAND', u'NLCD2006_FS_C31_7500_ED', u'NLCD2006_FS_C31_7500_LPI', u'NLCD2006_FS_C31_7500_PD', u'NLCD2006_FS_C31_7500_PLAND', u'NLCD2006_FS_C31_750_ED', u'NLCD2006_FS_C31_750_LPI', u'NLCD2006_FS_C31_750_PD', u'NLCD2006_FS_C31_750_PLAND', u'NLCD2006_FS_C31_75_ED', u'NLCD2006_FS_C31_75_LPI', u'NLCD2006_FS_C31_75_PD', u'NLCD2006_FS_C31_75_PLAND', u'NLCD2006_FS_C41_7500_ED', u'NLCD2006_FS_C41_7500_LPI', u'NLCD2006_FS_C41_7500_PD', u'NLCD2006_FS_C41_7500_PLAND', u'NLCD2006_FS_C41_750_ED', u'NLCD2006_FS_C41_750_LPI', u'NLCD2006_FS_C41_750_PD', u'NLCD2006_FS_C41_750_PLAND', u'NLCD2006_FS_C41_75_ED', u'NLCD2006_FS_C41_75_LPI', u'NLCD2006_FS_C41_75_PD', u'NLCD2006_FS_C41_75_PLAND', u'NLCD2006_FS_C42_7500_ED', u'NLCD2006_FS_C42_7500_LPI', u'NLCD2006_FS_C42_7500_PD', u'NLCD2006_FS_C42_7500_PLAND', u'NLCD2006_FS_C42_750_ED', u'NLCD2006_FS_C42_750_LPI', u'NLCD2006_FS_C42_750_PD', u'NLCD2006_FS_C42_750_PLAND', u'NLCD2006_FS_C42_75_ED', u'NLCD2006_FS_C42_75_LPI', u'NLCD2006_FS_C42_75_PD', u'NLCD2006_FS_C42_75_PLAND', u'NLCD2006_FS_C43_7500_ED', u'NLCD2006_FS_C43_7500_LPI', u'NLCD2006_FS_C43_7500_PD', u'NLCD2006_FS_C43_7500_PLAND', u'NLCD2006_FS_C43_750_ED', u'NLCD2006_FS_C43_750_LPI', u'NLCD2006_FS_C43_750_PD', u'NLCD2006_FS_C43_750_PLAND', u'NLCD2006_FS_C43_75_ED', u'NLCD2006_FS_C43_75_LPI', u'NLCD2006_FS_C43_75_PD', u'NLCD2006_FS_C43_75_PLAND', u'NLCD2006_FS_C52_7500_ED', u'NLCD2006_FS_C52_7500_LPI', u'NLCD2006_FS_C52_7500_PD', u'NLCD2006_FS_C52_7500_PLAND', u'NLCD2006_FS_C52_750_ED', u'NLCD2006_FS_C52_750_LPI', u'NLCD2006_FS_C52_750_PD', u'NLCD2006_FS_C52_750_PLAND', u'NLCD2006_FS_C52_75_ED', u'NLCD2006_FS_C52_75_LPI', u'NLCD2006_FS_C52_75_PD', u'NLCD2006_FS_C52_75_PLAND', u'NLCD2006_FS_C71_7500_ED', u'NLCD2006_FS_C71_7500_LPI', u'NLCD2006_FS_C71_7500_PD', u'NLCD2006_FS_C71_7500_PLAND', u'NLCD2006_FS_C71_750_ED', u'NLCD2006_FS_C71_750_LPI', u'NLCD2006_FS_C71_750_PD', u'NLCD2006_FS_C71_750_PLAND', u'NLCD2006_FS_C71_75_ED', u'NLCD2006_FS_C71_75_LPI', u'NLCD2006_FS_C71_75_PD', u'NLCD2006_FS_C71_75_PLAND', u'NLCD2006_FS_C81_7500_ED', u'NLCD2006_FS_C81_7500_LPI', u'NLCD2006_FS_C81_7500_PD', u'NLCD2006_FS_C81_7500_PLAND', u'NLCD2006_FS_C81_750_ED', u'NLCD2006_FS_C81_750_LPI', u'NLCD2006_FS_C81_750_PD', u'NLCD2006_FS_C81_750_PLAND', u'NLCD2006_FS_C81_75_ED', u'NLCD2006_FS_C81_75_LPI', u'NLCD2006_FS_C81_75_PD', u'NLCD2006_FS_C81_75_PLAND', u'NLCD2006_FS_C82_7500_ED', u'NLCD2006_FS_C82_7500_LPI', u'NLCD2006_FS_C82_7500_PD', u'NLCD2006_FS_C82_7500_PLAND', u'NLCD2006_FS_C82_750_ED', u'NLCD2006_FS_C82_750_LPI', u'NLCD2006_FS_C82_750_PD', u'NLCD2006_FS_C82_750_PLAND', u'NLCD2006_FS_C82_75_ED', u'NLCD2006_FS_C82_75_LPI', u'NLCD2006_FS_C82_75_PD', u'NLCD2006_FS_C82_75_PLAND', u'NLCD2006_FS_C90_7500_ED', u'NLCD2006_FS_C90_7500_LPI', u'NLCD2006_FS_C90_7500_PD', u'NLCD2006_FS_C90_7500_PLAND', u'NLCD2006_FS_C90_750_ED', u'NLCD2006_FS_C90_750_LPI', u'NLCD2006_FS_C90_750_PD', u'NLCD2006_FS_C90_750_PLAND', u'NLCD2006_FS_C90_75_ED', u'NLCD2006_FS_C90_75_LPI', u'NLCD2006_FS_C90_75_PD', u'NLCD2006_FS_C90_75_PLAND', u'NLCD2006_FS_C95_7500_ED', u'NLCD2006_FS_C95_7500_LPI', u'NLCD2006_FS_C95_7500_PD', u'NLCD2006_FS_C95_7500_PLAND', u'NLCD2006_FS_C95_750_ED', u'NLCD2006_FS_C95_750_LPI', u'NLCD2006_FS_C95_750_PD', u'NLCD2006_FS_C95_750_PLAND', u'NLCD2006_FS_C95_75_ED', u'NLCD2006_FS_C95_75_LPI', u'NLCD2006_FS_C95_75_PD', u'NLCD2006_FS_C95_75_PLAND', u'NLCD2006_FS_L_7500_ED', u'NLCD2006_FS_L_7500_LPI', u'NLCD2006_FS_L_7500_PD', u'NLCD2006_FS_L_750_ED', u'NLCD2006_FS_L_750_LPI', u'NLCD2006_FS_L_750_PD', u'NLCD2006_FS_L_75_ED', u'NLCD2006_FS_L_75_LPI', u'NLCD2006_FS_L_75_PD', u'POP00_SQMI', u'TIME', u'UMD2011_FS_C0_1500_ED', u'UMD2011_FS_C0_1500_LPI', u'UMD2011_FS_C0_1500_PD', u'UMD2011_FS_C0_1500_PLAND', u'UMD2011_FS_C10_1500_ED', u'UMD2011_FS_C10_1500_LPI', u'UMD2011_FS_C10_1500_PD', u'UMD2011_FS_C10_1500_PLAND', u'UMD2011_FS_C12_1500_ED', u'UMD2011_FS_C12_1500_LPI', u'UMD2011_FS_C12_1500_PD', u'UMD2011_FS_C12_1500_PLAND', u'UMD2011_FS_C13_1500_ED', u'UMD2011_FS_C13_1500_LPI', u'UMD2011_FS_C13_1500_PD', u'UMD2011_FS_C13_1500_PLAND', u'UMD2011_FS_C16_1500_ED', u'UMD2011_FS_C16_1500_LPI', u'UMD2011_FS_C16_1500_PD', u'UMD2011_FS_C16_1500_PLAND', u'UMD2011_FS_C1_1500_ED', u'UMD2011_FS_C1_1500_LPI', u'UMD2011_FS_C1_1500_PD', u'UMD2011_FS_C1_1500_PLAND', u'UMD2011_FS_C2_1500_ED', u'UMD2011_FS_C2_1500_LPI', u'UMD2011_FS_C2_1500_PD', u'UMD2011_FS_C2_1500_PLAND', u'UMD2011_FS_C3_1500_ED', u'UMD2011_FS_C3_1500_LPI', u'UMD2011_FS_C3_1500_PD', u'UMD2011_FS_C3_1500_PLAND', u'UMD2011_FS_C4_1500_ED', u'UMD2011_FS_C4_1500_LPI', u'UMD2011_FS_C4_1500_PD', u'UMD2011_FS_C4_1500_PLAND', u'UMD2011_FS_C5_1500_ED', u'UMD2011_FS_C5_1500_LPI', u'UMD2011_FS_C5_1500_PD', u'UMD2011_FS_C5_1500_PLAND', u'UMD2011_FS_C6_1500_ED', u'UMD2011_FS_C6_1500_LPI', u'UMD2011_FS_C6_1500_PD', u'UMD2011_FS_C6_1500_PLAND', u'UMD2011_FS_C7_1500_ED', u'UMD2011_FS_C7_1500_LPI', u'UMD2011_FS_C7_1500_PD', u'UMD2011_FS_C7_1500_PLAND', u'UMD2011_FS_C8_1500_ED', u'UMD2011_FS_C8_1500_LPI', u'UMD2011_FS_C8_1500_PD', u'UMD2011_FS_C8_1500_PLAND', u'UMD2011_FS_C9_1500_ED', u'UMD2011_FS_C9_1500_LPI', u'UMD2011_FS_C9_1500_PD', u'UMD2011_FS_C9_1500_PLAND', u'UMD2011_FS_L_1500_ED', u'UMD2011_FS_L_1500_LPI', u'UMD2011_FS_L_1500_PD', u'UMD2011_LANDCOVER', u'YEAR']
cat_metadata = []
num_metadata = [u'ASTER2011_DEM', u'CAUS_FIRST_AUTUMN_32F_EXTREME', u'CAUS_FIRST_AUTUMN_32F_MEAN', u'CAUS_FIRST_AUTUMN_32F_MEDIAN', u'CAUS_LAST_SPRING_32F_EXTREME', u'CAUS_LAST_SPRING_32F_MEAN', u'CAUS_LAST_SPRING_32F_MEDIAN', u'CAUS_PREC', u'CAUS_PREC01', u'CAUS_PREC02', u'CAUS_PREC03', u'CAUS_PREC04', u'CAUS_PREC05', u'CAUS_PREC06', u'CAUS_PREC07', u'CAUS_PREC08', u'CAUS_PREC09', u'CAUS_PREC10', u'CAUS_PREC11', u'CAUS_PREC12', u'CAUS_PREC13', u'CAUS_SNOW', u'CAUS_SNOW01', u'CAUS_SNOW02', u'CAUS_SNOW03', u'CAUS_SNOW04', u'CAUS_SNOW10', u'CAUS_SNOW11', u'CAUS_SNOW12', u'CAUS_TEMP_AVG', u'CAUS_TEMP_AVG01', u'CAUS_TEMP_AVG02', u'CAUS_TEMP_AVG03', u'CAUS_TEMP_AVG04', u'CAUS_TEMP_AVG05', u'CAUS_TEMP_AVG06', u'CAUS_TEMP_AVG07', u'CAUS_TEMP_AVG08', u'CAUS_TEMP_AVG09', u'CAUS_TEMP_AVG10', u'CAUS_TEMP_AVG11', u'CAUS_TEMP_AVG12', u'CAUS_TEMP_AVG13', u'CAUS_TEMP_MAX', u'CAUS_TEMP_MAX01', u'CAUS_TEMP_MAX02', u'CAUS_TEMP_MAX03', u'CAUS_TEMP_MAX04', u'CAUS_TEMP_MAX05', u'CAUS_TEMP_MAX06', u'CAUS_TEMP_MAX07', u'CAUS_TEMP_MAX08', u'CAUS_TEMP_MAX09', u'CAUS_TEMP_MAX10', u'CAUS_TEMP_MAX11', u'CAUS_TEMP_MAX12', u'CAUS_TEMP_MAX13', u'CAUS_TEMP_MIN', u'CAUS_TEMP_MIN01', u'CAUS_TEMP_MIN02', u'CAUS_TEMP_MIN03', u'CAUS_TEMP_MIN04', u'CAUS_TEMP_MIN05', u'CAUS_TEMP_MIN06', u'CAUS_TEMP_MIN07', u'CAUS_TEMP_MIN08', u'CAUS_TEMP_MIN09', u'CAUS_TEMP_MIN10', u'CAUS_TEMP_MIN11', u'CAUS_TEMP_MIN12', u'CAUS_TEMP_MIN13', u'DAY', u'DIST_FROM_FLOWING_BRACKISH', u'DIST_FROM_FLOWING_FRESH', u'DIST_FROM_STANDING_BRACKISH', u'DIST_FROM_STANDING_FRESH', u'DIST_FROM_WET_VEG_BRACKISH', u'DIST_FROM_WET_VEG_FRESH', u'DIST_IN_FLOWING_BRACKISH', u'DIST_IN_FLOWING_FRESH', u'DIST_IN_STANDING_BRACKISH', u'DIST_IN_STANDING_FRESH', u'DIST_IN_WET_VEG_BRACKISH', u'DIST_IN_WET_VEG_FRESH', u'EFFORT_AREA_HA', u'EFFORT_DISTANCE_KM', u'EFFORT_HRS', u'ELEV_GT', u'ELEV_NED', u'HOUSING_DENSITY', u'HOUSING_PERCENT_VACANT', u'LATITUDE', u'LONGITUDE', u'NLCD01_CANOPYMEAN_RAD75', u'NLCD01_CANOPYMEAN_RAD750', u'NLCD01_CANOPYMEAN_RAD7500', u'NLCD01_IMPERVMEAN_RAD75', u'NLCD01_IMPERVMEAN_RAD750', u'NLCD01_IMPERVMEAN_RAD7500', u'NLCD2001_FS_C11_7500_ED', u'NLCD2001_FS_C11_7500_LPI', u'NLCD2001_FS_C11_7500_PD', u'NLCD2001_FS_C11_7500_PLAND', u'NLCD2001_FS_C11_750_ED', u'NLCD2001_FS_C11_750_LPI', u'NLCD2001_FS_C11_750_PD', u'NLCD2001_FS_C11_750_PLAND', u'NLCD2001_FS_C11_75_ED', u'NLCD2001_FS_C11_75_LPI', u'NLCD2001_FS_C11_75_PD', u'NLCD2001_FS_C11_75_PLAND', u'NLCD2001_FS_C12_7500_ED', u'NLCD2001_FS_C12_7500_LPI', u'NLCD2001_FS_C12_7500_PD', u'NLCD2001_FS_C12_7500_PLAND', u'NLCD2001_FS_C12_750_ED', u'NLCD2001_FS_C12_750_LPI', u'NLCD2001_FS_C12_750_PD', u'NLCD2001_FS_C12_750_PLAND', u'NLCD2001_FS_C12_75_ED', u'NLCD2001_FS_C12_75_LPI', u'NLCD2001_FS_C12_75_PD', u'NLCD2001_FS_C12_75_PLAND', u'NLCD2001_FS_C21_7500_ED', u'NLCD2001_FS_C21_7500_LPI', u'NLCD2001_FS_C21_7500_PD', u'NLCD2001_FS_C21_7500_PLAND', u'NLCD2001_FS_C21_750_ED', u'NLCD2001_FS_C21_750_LPI', u'NLCD2001_FS_C21_750_PD', u'NLCD2001_FS_C21_750_PLAND', u'NLCD2001_FS_C21_75_ED', u'NLCD2001_FS_C21_75_LPI', u'NLCD2001_FS_C21_75_PD', u'NLCD2001_FS_C21_75_PLAND', u'NLCD2001_FS_C22_7500_ED', u'NLCD2001_FS_C22_7500_LPI', u'NLCD2001_FS_C22_7500_PD', u'NLCD2001_FS_C22_7500_PLAND', u'NLCD2001_FS_C22_750_ED', u'NLCD2001_FS_C22_750_LPI', u'NLCD2001_FS_C22_750_PD', u'NLCD2001_FS_C22_750_PLAND', u'NLCD2001_FS_C22_75_ED', u'NLCD2001_FS_C22_75_LPI', u'NLCD2001_FS_C22_75_PD', u'NLCD2001_FS_C22_75_PLAND', u'NLCD2001_FS_C23_7500_ED', u'NLCD2001_FS_C23_7500_LPI', u'NLCD2001_FS_C23_7500_PD', u'NLCD2001_FS_C23_7500_PLAND', u'NLCD2001_FS_C23_750_ED', u'NLCD2001_FS_C23_750_LPI', u'NLCD2001_FS_C23_750_PD', u'NLCD2001_FS_C23_750_PLAND', u'NLCD2001_FS_C23_75_ED', u'NLCD2001_FS_C23_75_LPI', u'NLCD2001_FS_C23_75_PD', u'NLCD2001_FS_C23_75_PLAND', u'NLCD2001_FS_C24_7500_ED', u'NLCD2001_FS_C24_7500_LPI', u'NLCD2001_FS_C24_7500_PD', u'NLCD2001_FS_C24_7500_PLAND', u'NLCD2001_FS_C24_750_ED', u'NLCD2001_FS_C24_750_LPI', u'NLCD2001_FS_C24_750_PD', u'NLCD2001_FS_C24_750_PLAND', u'NLCD2001_FS_C24_75_ED', u'NLCD2001_FS_C24_75_LPI', u'NLCD2001_FS_C24_75_PD', u'NLCD2001_FS_C24_75_PLAND', u'NLCD2001_FS_C31_7500_ED', u'NLCD2001_FS_C31_7500_LPI', u'NLCD2001_FS_C31_7500_PD', u'NLCD2001_FS_C31_7500_PLAND', u'NLCD2001_FS_C31_750_ED', u'NLCD2001_FS_C31_750_LPI', u'NLCD2001_FS_C31_750_PD', u'NLCD2001_FS_C31_750_PLAND', u'NLCD2001_FS_C31_75_ED', u'NLCD2001_FS_C31_75_LPI', u'NLCD2001_FS_C31_75_PD', u'NLCD2001_FS_C31_75_PLAND', u'NLCD2001_FS_C41_7500_ED', u'NLCD2001_FS_C41_7500_LPI', u'NLCD2001_FS_C41_7500_PD', u'NLCD2001_FS_C41_7500_PLAND', u'NLCD2001_FS_C41_750_ED', u'NLCD2001_FS_C41_750_LPI', u'NLCD2001_FS_C41_750_PD', u'NLCD2001_FS_C41_750_PLAND', u'NLCD2001_FS_C41_75_ED', u'NLCD2001_FS_C41_75_LPI', u'NLCD2001_FS_C41_75_PD', u'NLCD2001_FS_C41_75_PLAND', u'NLCD2001_FS_C42_7500_ED', u'NLCD2001_FS_C42_7500_LPI', u'NLCD2001_FS_C42_7500_PD', u'NLCD2001_FS_C42_7500_PLAND', u'NLCD2001_FS_C42_750_ED', u'NLCD2001_FS_C42_750_LPI', u'NLCD2001_FS_C42_750_PD', u'NLCD2001_FS_C42_750_PLAND', u'NLCD2001_FS_C42_75_ED', u'NLCD2001_FS_C42_75_LPI', u'NLCD2001_FS_C42_75_PD', u'NLCD2001_FS_C42_75_PLAND', u'NLCD2001_FS_C43_7500_ED', u'NLCD2001_FS_C43_7500_LPI', u'NLCD2001_FS_C43_7500_PD', u'NLCD2001_FS_C43_7500_PLAND', u'NLCD2001_FS_C43_750_ED', u'NLCD2001_FS_C43_750_LPI', u'NLCD2001_FS_C43_750_PD', u'NLCD2001_FS_C43_750_PLAND', u'NLCD2001_FS_C43_75_ED', u'NLCD2001_FS_C43_75_LPI', u'NLCD2001_FS_C43_75_PD', u'NLCD2001_FS_C43_75_PLAND', u'NLCD2001_FS_C52_7500_ED', u'NLCD2001_FS_C52_7500_LPI', u'NLCD2001_FS_C52_7500_PD', u'NLCD2001_FS_C52_7500_PLAND', u'NLCD2001_FS_C52_750_ED', u'NLCD2001_FS_C52_750_LPI', u'NLCD2001_FS_C52_750_PD', u'NLCD2001_FS_C52_750_PLAND', u'NLCD2001_FS_C52_75_ED', u'NLCD2001_FS_C52_75_LPI', u'NLCD2001_FS_C52_75_PD', u'NLCD2001_FS_C52_75_PLAND', u'NLCD2001_FS_C71_7500_ED', u'NLCD2001_FS_C71_7500_LPI', u'NLCD2001_FS_C71_7500_PD', u'NLCD2001_FS_C71_7500_PLAND', u'NLCD2001_FS_C71_750_ED', u'NLCD2001_FS_C71_750_LPI', u'NLCD2001_FS_C71_750_PD', u'NLCD2001_FS_C71_750_PLAND', u'NLCD2001_FS_C71_75_ED', u'NLCD2001_FS_C71_75_LPI', u'NLCD2001_FS_C71_75_PD', u'NLCD2001_FS_C71_75_PLAND', u'NLCD2001_FS_C81_7500_ED', u'NLCD2001_FS_C81_7500_LPI', u'NLCD2001_FS_C81_7500_PD', u'NLCD2001_FS_C81_7500_PLAND', u'NLCD2001_FS_C81_750_ED', u'NLCD2001_FS_C81_750_LPI', u'NLCD2001_FS_C81_750_PD', u'NLCD2001_FS_C81_750_PLAND', u'NLCD2001_FS_C81_75_ED', u'NLCD2001_FS_C81_75_LPI', u'NLCD2001_FS_C81_75_PD', u'NLCD2001_FS_C81_75_PLAND', u'NLCD2001_FS_C82_7500_ED', u'NLCD2001_FS_C82_7500_LPI', u'NLCD2001_FS_C82_7500_PD', u'NLCD2001_FS_C82_7500_PLAND', u'NLCD2001_FS_C82_750_ED', u'NLCD2001_FS_C82_750_LPI', u'NLCD2001_FS_C82_750_PD', u'NLCD2001_FS_C82_750_PLAND', u'NLCD2001_FS_C82_75_ED', u'NLCD2001_FS_C82_75_LPI', u'NLCD2001_FS_C82_75_PD', u'NLCD2001_FS_C82_75_PLAND', u'NLCD2001_FS_C90_7500_ED', u'NLCD2001_FS_C90_7500_LPI', u'NLCD2001_FS_C90_7500_PD', u'NLCD2001_FS_C90_7500_PLAND', u'NLCD2001_FS_C90_750_ED', u'NLCD2001_FS_C90_750_LPI', u'NLCD2001_FS_C90_750_PD', u'NLCD2001_FS_C90_750_PLAND', u'NLCD2001_FS_C90_75_ED', u'NLCD2001_FS_C90_75_LPI', u'NLCD2001_FS_C90_75_PD', u'NLCD2001_FS_C90_75_PLAND', u'NLCD2001_FS_C95_7500_ED', u'NLCD2001_FS_C95_7500_LPI', u'NLCD2001_FS_C95_7500_PD', u'NLCD2001_FS_C95_7500_PLAND', u'NLCD2001_FS_C95_750_ED', u'NLCD2001_FS_C95_750_LPI', u'NLCD2001_FS_C95_750_PD', u'NLCD2001_FS_C95_750_PLAND', u'NLCD2001_FS_C95_75_ED', u'NLCD2001_FS_C95_75_LPI', u'NLCD2001_FS_C95_75_PD', u'NLCD2001_FS_C95_75_PLAND', u'NLCD2001_FS_L_7500_ED', u'NLCD2001_FS_L_7500_LPI', u'NLCD2001_FS_L_7500_PD', u'NLCD2001_FS_L_750_ED', u'NLCD2001_FS_L_750_LPI', u'NLCD2001_FS_L_750_PD', u'NLCD2001_FS_L_75_ED', u'NLCD2001_FS_L_75_LPI', u'NLCD2001_FS_L_75_PD', u'NLCD2006_FS_C11_7500_ED', u'NLCD2006_FS_C11_7500_LPI', u'NLCD2006_FS_C11_7500_PD', u'NLCD2006_FS_C11_7500_PLAND', u'NLCD2006_FS_C11_750_ED', u'NLCD2006_FS_C11_750_LPI', u'NLCD2006_FS_C11_750_PD', u'NLCD2006_FS_C11_750_PLAND', u'NLCD2006_FS_C11_75_ED', u'NLCD2006_FS_C11_75_LPI', u'NLCD2006_FS_C11_75_PD', u'NLCD2006_FS_C11_75_PLAND', u'NLCD2006_FS_C12_7500_ED', u'NLCD2006_FS_C12_7500_LPI', u'NLCD2006_FS_C12_7500_PD', u'NLCD2006_FS_C12_7500_PLAND', u'NLCD2006_FS_C12_750_ED', u'NLCD2006_FS_C12_750_LPI', u'NLCD2006_FS_C12_750_PD', u'NLCD2006_FS_C12_750_PLAND', u'NLCD2006_FS_C12_75_ED', u'NLCD2006_FS_C12_75_LPI', u'NLCD2006_FS_C12_75_PD', u'NLCD2006_FS_C12_75_PLAND', u'NLCD2006_FS_C21_7500_ED', u'NLCD2006_FS_C21_7500_LPI', u'NLCD2006_FS_C21_7500_PD', u'NLCD2006_FS_C21_7500_PLAND', u'NLCD2006_FS_C21_750_ED', u'NLCD2006_FS_C21_750_LPI', u'NLCD2006_FS_C21_750_PD', u'NLCD2006_FS_C21_750_PLAND', u'NLCD2006_FS_C21_75_ED', u'NLCD2006_FS_C21_75_LPI', u'NLCD2006_FS_C21_75_PD', u'NLCD2006_FS_C21_75_PLAND', u'NLCD2006_FS_C22_7500_ED', u'NLCD2006_FS_C22_7500_LPI', u'NLCD2006_FS_C22_7500_PD', u'NLCD2006_FS_C22_7500_PLAND', u'NLCD2006_FS_C22_750_ED', u'NLCD2006_FS_C22_750_LPI', u'NLCD2006_FS_C22_750_PD', u'NLCD2006_FS_C22_750_PLAND', u'NLCD2006_FS_C22_75_ED', u'NLCD2006_FS_C22_75_LPI', u'NLCD2006_FS_C22_75_PD', u'NLCD2006_FS_C22_75_PLAND', u'NLCD2006_FS_C23_7500_ED', u'NLCD2006_FS_C23_7500_LPI', u'NLCD2006_FS_C23_7500_PD', u'NLCD2006_FS_C23_7500_PLAND', u'NLCD2006_FS_C23_750_ED', u'NLCD2006_FS_C23_750_LPI', u'NLCD2006_FS_C23_750_PD', u'NLCD2006_FS_C23_750_PLAND', u'NLCD2006_FS_C23_75_ED', u'NLCD2006_FS_C23_75_LPI', u'NLCD2006_FS_C23_75_PD', u'NLCD2006_FS_C23_75_PLAND', u'NLCD2006_FS_C24_7500_ED', u'NLCD2006_FS_C24_7500_LPI', u'NLCD2006_FS_C24_7500_PD', u'NLCD2006_FS_C24_7500_PLAND', u'NLCD2006_FS_C24_750_ED', u'NLCD2006_FS_C24_750_LPI', u'NLCD2006_FS_C24_750_PD', u'NLCD2006_FS_C24_750_PLAND', u'NLCD2006_FS_C24_75_ED', u'NLCD2006_FS_C24_75_LPI', u'NLCD2006_FS_C24_75_PD', u'NLCD2006_FS_C24_75_PLAND', u'NLCD2006_FS_C31_7500_ED', u'NLCD2006_FS_C31_7500_LPI', u'NLCD2006_FS_C31_7500_PD', u'NLCD2006_FS_C31_7500_PLAND', u'NLCD2006_FS_C31_750_ED', u'NLCD2006_FS_C31_750_LPI', u'NLCD2006_FS_C31_750_PD', u'NLCD2006_FS_C31_750_PLAND', u'NLCD2006_FS_C31_75_ED', u'NLCD2006_FS_C31_75_LPI', u'NLCD2006_FS_C31_75_PD', u'NLCD2006_FS_C31_75_PLAND', u'NLCD2006_FS_C41_7500_ED', u'NLCD2006_FS_C41_7500_LPI', u'NLCD2006_FS_C41_7500_PD', u'NLCD2006_FS_C41_7500_PLAND', u'NLCD2006_FS_C41_750_ED', u'NLCD2006_FS_C41_750_LPI', u'NLCD2006_FS_C41_750_PD', u'NLCD2006_FS_C41_750_PLAND', u'NLCD2006_FS_C41_75_ED', u'NLCD2006_FS_C41_75_LPI', u'NLCD2006_FS_C41_75_PD', u'NLCD2006_FS_C41_75_PLAND', u'NLCD2006_FS_C42_7500_ED', u'NLCD2006_FS_C42_7500_LPI', u'NLCD2006_FS_C42_7500_PD', u'NLCD2006_FS_C42_7500_PLAND', u'NLCD2006_FS_C42_750_ED', u'NLCD2006_FS_C42_750_LPI', u'NLCD2006_FS_C42_750_PD', u'NLCD2006_FS_C42_750_PLAND', u'NLCD2006_FS_C42_75_ED', u'NLCD2006_FS_C42_75_LPI', u'NLCD2006_FS_C42_75_PD', u'NLCD2006_FS_C42_75_PLAND', u'NLCD2006_FS_C43_7500_ED', u'NLCD2006_FS_C43_7500_LPI', u'NLCD2006_FS_C43_7500_PD', u'NLCD2006_FS_C43_7500_PLAND', u'NLCD2006_FS_C43_750_ED', u'NLCD2006_FS_C43_750_LPI', u'NLCD2006_FS_C43_750_PD', u'NLCD2006_FS_C43_750_PLAND', u'NLCD2006_FS_C43_75_ED', u'NLCD2006_FS_C43_75_LPI', u'NLCD2006_FS_C43_75_PD', u'NLCD2006_FS_C43_75_PLAND', u'NLCD2006_FS_C52_7500_ED', u'NLCD2006_FS_C52_7500_LPI', u'NLCD2006_FS_C52_7500_PD', u'NLCD2006_FS_C52_7500_PLAND', u'NLCD2006_FS_C52_750_ED', u'NLCD2006_FS_C52_750_LPI', u'NLCD2006_FS_C52_750_PD', u'NLCD2006_FS_C52_750_PLAND', u'NLCD2006_FS_C52_75_ED', u'NLCD2006_FS_C52_75_LPI', u'NLCD2006_FS_C52_75_PD', u'NLCD2006_FS_C52_75_PLAND', u'NLCD2006_FS_C71_7500_ED', u'NLCD2006_FS_C71_7500_LPI', u'NLCD2006_FS_C71_7500_PD', u'NLCD2006_FS_C71_7500_PLAND', u'NLCD2006_FS_C71_750_ED', u'NLCD2006_FS_C71_750_LPI', u'NLCD2006_FS_C71_750_PD', u'NLCD2006_FS_C71_750_PLAND', u'NLCD2006_FS_C71_75_ED', u'NLCD2006_FS_C71_75_LPI', u'NLCD2006_FS_C71_75_PD', u'NLCD2006_FS_C71_75_PLAND', u'NLCD2006_FS_C81_7500_ED', u'NLCD2006_FS_C81_7500_LPI', u'NLCD2006_FS_C81_7500_PD', u'NLCD2006_FS_C81_7500_PLAND', u'NLCD2006_FS_C81_750_ED', u'NLCD2006_FS_C81_750_LPI', u'NLCD2006_FS_C81_750_PD', u'NLCD2006_FS_C81_750_PLAND', u'NLCD2006_FS_C81_75_ED', u'NLCD2006_FS_C81_75_LPI', u'NLCD2006_FS_C81_75_PD', u'NLCD2006_FS_C81_75_PLAND', u'NLCD2006_FS_C82_7500_ED', u'NLCD2006_FS_C82_7500_LPI', u'NLCD2006_FS_C82_7500_PD', u'NLCD2006_FS_C82_7500_PLAND', u'NLCD2006_FS_C82_750_ED', u'NLCD2006_FS_C82_750_LPI', u'NLCD2006_FS_C82_750_PD', u'NLCD2006_FS_C82_750_PLAND', u'NLCD2006_FS_C82_75_ED', u'NLCD2006_FS_C82_75_LPI', u'NLCD2006_FS_C82_75_PD', u'NLCD2006_FS_C82_75_PLAND', u'NLCD2006_FS_C90_7500_ED', u'NLCD2006_FS_C90_7500_LPI', u'NLCD2006_FS_C90_7500_PD', u'NLCD2006_FS_C90_7500_PLAND', u'NLCD2006_FS_C90_750_ED', u'NLCD2006_FS_C90_750_LPI', u'NLCD2006_FS_C90_750_PD', u'NLCD2006_FS_C90_750_PLAND', u'NLCD2006_FS_C90_75_ED', u'NLCD2006_FS_C90_75_LPI', u'NLCD2006_FS_C90_75_PD', u'NLCD2006_FS_C90_75_PLAND', u'NLCD2006_FS_C95_7500_ED', u'NLCD2006_FS_C95_7500_LPI', u'NLCD2006_FS_C95_7500_PD', u'NLCD2006_FS_C95_7500_PLAND', u'NLCD2006_FS_C95_750_ED', u'NLCD2006_FS_C95_750_LPI', u'NLCD2006_FS_C95_750_PD', u'NLCD2006_FS_C95_750_PLAND', u'NLCD2006_FS_C95_75_ED', u'NLCD2006_FS_C95_75_LPI', u'NLCD2006_FS_C95_75_PD', u'NLCD2006_FS_C95_75_PLAND', u'NLCD2006_FS_L_7500_ED', u'NLCD2006_FS_L_7500_LPI', u'NLCD2006_FS_L_7500_PD', u'NLCD2006_FS_L_750_ED', u'NLCD2006_FS_L_750_LPI', u'NLCD2006_FS_L_750_PD', u'NLCD2006_FS_L_75_ED', u'NLCD2006_FS_L_75_LPI', u'NLCD2006_FS_L_75_PD', u'POP00_SQMI', u'TIME', u'UMD2011_FS_C0_1500_ED', u'UMD2011_FS_C0_1500_LPI', u'UMD2011_FS_C0_1500_PD', u'UMD2011_FS_C0_1500_PLAND', u'UMD2011_FS_C10_1500_ED', u'UMD2011_FS_C10_1500_LPI', u'UMD2011_FS_C10_1500_PD', u'UMD2011_FS_C10_1500_PLAND', u'UMD2011_FS_C12_1500_ED', u'UMD2011_FS_C12_1500_LPI', u'UMD2011_FS_C12_1500_PD', u'UMD2011_FS_C12_1500_PLAND', u'UMD2011_FS_C13_1500_ED', u'UMD2011_FS_C13_1500_LPI', u'UMD2011_FS_C13_1500_PD', u'UMD2011_FS_C13_1500_PLAND', u'UMD2011_FS_C16_1500_ED', u'UMD2011_FS_C16_1500_LPI', u'UMD2011_FS_C16_1500_PD', u'UMD2011_FS_C16_1500_PLAND', u'UMD2011_FS_C1_1500_ED', u'UMD2011_FS_C1_1500_LPI', u'UMD2011_FS_C1_1500_PD', u'UMD2011_FS_C1_1500_PLAND', u'UMD2011_FS_C2_1500_ED', u'UMD2011_FS_C2_1500_LPI', u'UMD2011_FS_C2_1500_PD', u'UMD2011_FS_C2_1500_PLAND', u'UMD2011_FS_C3_1500_ED', u'UMD2011_FS_C3_1500_LPI', u'UMD2011_FS_C3_1500_PD', u'UMD2011_FS_C3_1500_PLAND', u'UMD2011_FS_C4_1500_ED', u'UMD2011_FS_C4_1500_LPI', u'UMD2011_FS_C4_1500_PD', u'UMD2011_FS_C4_1500_PLAND', u'UMD2011_FS_C5_1500_ED', u'UMD2011_FS_C5_1500_LPI', u'UMD2011_FS_C5_1500_PD', u'UMD2011_FS_C5_1500_PLAND', u'UMD2011_FS_C6_1500_ED', u'UMD2011_FS_C6_1500_LPI', u'UMD2011_FS_C6_1500_PD', u'UMD2011_FS_C6_1500_PLAND', u'UMD2011_FS_C7_1500_ED', u'UMD2011_FS_C7_1500_LPI', u'UMD2011_FS_C7_1500_PD', u'UMD2011_FS_C7_1500_PLAND', u'UMD2011_FS_C8_1500_ED', u'UMD2011_FS_C8_1500_LPI', u'UMD2011_FS_C8_1500_PD', u'UMD2011_FS_C8_1500_PLAND', u'UMD2011_FS_C9_1500_ED', u'UMD2011_FS_C9_1500_LPI', u'UMD2011_FS_C9_1500_PD', u'UMD2011_FS_C9_1500_PLAND', u'UMD2011_FS_L_1500_ED', u'UMD2011_FS_L_1500_LPI', u'UMD2011_FS_L_1500_PD', u'UMD2011_LANDCOVER', u'YEAR']
excluded_metadata = [u'BAILEY_ECOREGION', u'BCR', u'COUNT_TYPE', u'OMERNIK_L3_ECOREGION', u'MONTH', u'COUNTRY',u'STATE_PROVINCE', u'NUMBER_OBSERVERS', u'OBSERVER_ID', u'PRIMARY_CHECKLIST_FLAG', u'GROUP_ID',  u'SUBNATIONAL2_CODE']
metadata_excluded_prefixes = [u"NLCD",u"UMD2011_FS", u'EFFORT_', u"DIST_IN"]
num_metadata = [s for s in num_metadata if not any([s.startswith(x) for x in metadata_excluded_prefixes])]
cat_metadata = [s for s in cat_metadata if not any([s.startswith(x) for x in metadata_excluded_prefixes])]

ten_species = ['Zenaida_macroura', 'Corvus_brachyrhynchos', 'Cardinalis_cardinalis', 'Turdus_migratorius', 'Cyanocitta_cristata', 'Spinus_tristis', 'Sturnus_vulgaris', 'Melospiza_melodia', 'Agelaius_phoeniceus', 'Picoides_pubescens']
hundred_species = ['Zenaida_macroura', 'Corvus_brachyrhynchos', 'Cardinalis_cardinalis', 'Turdus_migratorius', 'Cyanocitta_cristata', 'Spinus_tristis', 'Sturnus_vulgaris', 'Melospiza_melodia', 'Agelaius_phoeniceus', 'Picoides_pubescens', 'Anas_platyrhynchos', 'Haemorhous_mexicanus', 'Branta_canadensis', 'Passer_domesticus', 'Poecile_atricapillus', 'Melanerpes_carolinus', 'Baeolophus_bicolor', 'Cathartes_aura', 'Ardea_herodias', 'Mimus_polyglottos', 'Sitta_carolinensis', 'Quiscalus_quiscula', 'Thryothorus_ludovicianus', 'Buteo_jamaicensis', 'Larus_delawarensis', 'Charadrius_vociferus', 'Colaptes_auratus', 'Phalacrocorax_auritus', 'Poecile_carolinensis', 'Columba_livia', 'Hirundo_rustica', 'Molothrus_ater', 'Junco_hyemalis', 'Zonotrichia_albicollis', 'Dumetella_carolinensis', 'Spizella_passerina', 'Geothlypis_trichas', 'Tachycineta_bicolor', 'Ardea_alba', 'Sialia_sialis', 'Megaceryle_alcyon', 'Sayornis_phoebe', 'Setophaga_coronata', 'Bombycilla_cedrorum', 'Fulica_americana', 'Regulus_calendula', 'Picoides_villosus', 'Troglodytes_aedon', 'Pipilo_erythrophthalmus', 'Falco_sparverius', 'Podilymbus_podiceps', 'Corvus_corax', 'Larus_argentatus', 'Zonotrichia_leucophrys', 'Polioptila_caerulea', 'Aix_sponsa', 'Setophaga_petechia', 'Pandion_haliaetus', 'Vireo_olivaceus', 'Dryocopus_pileatus', 'Chaetura_pelagica', 'Haliaeetus_leucocephalus', 'Passerina_cyanea', 'Buteo_lineatus', 'Egretta_thula', 'Bucephala_albeola', 'Archilochus_colubris', 'Accipiter_cooperii', 'Circus_cyaneus', 'Sitta_canadensis', 'Toxostoma_rufum', 'Anas_clypeata', 'Anas_strepera', 'Passerculus_sandwichensis', 'Tyrannus_tyrannus', 'Coragyps_atratus', 'Calypte_anna', 'Sayornis_nigricans', 'Pipilo_maculatus', 'Spizella_pusilla', 'Icterus_galbula', 'Myiarchus_crinitus', 'Oxyura_jamaicensis', 'Spinus_psaltria', 'Contopus_virens', 'Stelgidopteryx_serripennis', 'Butorides_virescens', 'Melospiza_georgiana', 'Regulus_satrapa', 'Corvus_ossifragus', 'Leucophaeus_atricilla', 'Catharus_guttatus', 'Anas_americana', 'Spinus_pinus', 'Tringa_melanoleuca', 'Streptopelia_decaocto', 'Aythya_collaris', 'Setophaga_ruticilla', 'Larus_marinus', 'Actitis_macularius', 'Anas_crecca']

species = ten_species

collection = "ebird"
from sklearn.preprocessing import StandardScaler,Imputer
from monary import Monary

uncounted_observation_replacement = 1 # What we replace observed-but-not-counted ("X" originally) with.

def load_ebird_pkl(fn):
	return pickle.load(open(fn,"rb"))

def monary_load(start=0,stop=-1, find_args={}, species_to_retrieve=[]):
	if species_to_retrieve == []:
		species_to_retrieve = species
	else:
		species_to_retrieve = [s for s in species_to_retrieve if s in species]
	query = {}
	for s in species_to_retrieve:
		query[s] = {"$gt": 0}
	find_args["$or"] = [{k:query[k]} for k in query.keys()]
	with Monary("127.0.0.1") as monary:
		out = monary.query(
			"creeval",
			collection,
			find_args,
			num_metadata+cat_metadata+species_to_retrieve,
			["float32"] * (len(num_metadata)+len(cat_metadata)+len(species_to_retrieve)),
			limit=(stop-start),
			offset=start
		)
	for i,col in enumerate(out[0:len(num_metadata+cat_metadata)]):
		out[i] = np.ma.filled(col,np.ma.mean(col))
		#if any(np.isnan(col)):
		#	print col
	out = np.ma.row_stack(out).T
	X = out[:,0:len(num_metadata+cat_metadata)]
	y = out[:,len(num_metadata+cat_metadata):]
	y = (y > 0).astype(int)

	scaler = StandardScaler().fit(X)
	X = scaler.transform(X)
	pickle.dump(scaler,open(collection+"_scaler.pkl","wb"))
	y = np.asarray(y)

	return DenseDesignMatrix(X=X,y=y)


def load_ebird_data(start=0,stop=-1, find_args={}, species_to_retrieve=[]):
	if species_to_retrieve == []:
		species_to_retrieve = species
	else:
		species_to_retrieve = [s for s in species_to_retrieve if s in species]
		query = {}
		for s in species_to_retrieve:
			query[s] = {"$gt": 0}
		find_args["$or"] = [{k:query[k]} for k in query.keys()]
	conn = pymongo.MongoClient()
	db = conn.creeval
	coll = db[collection]

	columns = num_metadata+cat_metadata
	if stop < 0:
		cursor = coll.find(find_args, skip=start)
		stop = cursor.count()
	else:
		cursor = coll.find(find_args, skip=start,limit=stop-start)
	limit = min(cursor.count(),stop-start)
	print cursor.count()
	X = np.zeros([limit,len(columns)])
	y = np.zeros([limit,len(species_to_retrieve)])

	row_num = 0
	for row_num,row in enumerate(cursor):
		if row_num % 10000 == 0:
			print row_num
		xrow = [row[k] for k in columns]
		for i,v in enumerate(xrow):
			if v == u"?":
				xrow[i] = float("NaN")
		keys = row.keys()
		yrow = [1*(s in keys) for s in species_to_retrieve]
		X[row_num] = xrow
		y[row_num] = yrow

	imp = Imputer(missing_values='NaN', strategy='mean', axis=0)
	imp.fit(X)
	X = imp.transform(X)
	scaler = StandardScaler().fit(X)
	X = scaler.transform(X)
	pickle.dump(scaler,open(collection+"_scaler.pkl","wb"))
	y = np.asarray(y)

	return DenseDesignMatrix(X=X,y=y)

def save_ebird_data(start,stop,find_args={}, out_file = "out.pkl"):
	pickle.dump(load_ebird_data(start,stop,find_args),open(out_file,"wb"))


def ebird_metadata_setup(collname, fields, species, insert_timefield = True, model_class = "SDAConceptualSpace"):

	client = pymongo.MongoClient()
	db = client.creeval
	metadata = db.datasets.find_one({"name": collname})
	if metadata is None:
		metadata = {"name": collname}

	metadata["fields_y"] = species
	metadata["fields_x"] = fields

	query = {}
	for s in species:
		query[s] = {"__gt": 0}
	metadata["query"] = {}
	metadata["query"]["__or"] = [{k:query[k]} for k in query.keys()]
	metadata["model_class"] = model_class

	if insert_timefield:
		print "Inserting timefield"
		timefield = 'timefield'
		metadata['timefield'] = timefield
		ebird_insert_timefield(collname, timefield)

	import pprint
	pprint.pprint(metadata)
	db.datasets.save(metadata)

def ebird_insert_timefield(collname="ebird",timefield="timefield"):
	client = pymongo.MongoClient()
	db = client.creeval
	#db.eval('db.ebird.copyTo("ebird_bkp")') # This seems to cause a bunch of errors, run it manually in the mongo console first.
	all = db[collname].find({})
	for i,row in enumerate(all):
		row[timefield] = row['YEAR'] + (float(row['DAY']) / 366.0)
		if i % 100000 == 0:
			print i,":",row[timefield],":",row['YEAR'],row['DAY']
		db.ebird.save(row)


if __name__ == "__main__":
	parser = argparse.ArgumentParser(description='Use this to import ebird data for use by creeval')
	parser.add_argument('-i','--input',help="Input csv dir",required=True)
	parser.add_argument('-o','--output',help='Output collection in DB',required=True)
	parser.add_argument('-f','--first',help="First year to grab (inclusive)",required=True, type=int)
	parser.add_argument('-l','--last',help='Last year to grab (inclusive)',required=True, type=int)
	args = parser.parse_args()
	client = MongoClient()
	db = client.creeval
	datasets = db.datasets
	data = db[args.output]



	for year in range(args.first,args.last+1):
		files = []
		readers = []
		print "----------"+str(year)+"----------"
		for file in os.listdir(os.path.join(args.input,str(year))):
			if file.endswith(".csv"):
				files.append(open(os.path.join(args.input,str(year),file)))
				readers.append(csv.DictReader(files[-1]))

		print readers
		count = 0
		missing_thresh = 0.75

		for k,row in enumerate(readers[0]):
			missing = 0
			outrow = {}
			if count % 100 == 0:
				print count,"("+str(k)+")"
			for reader in readers[1:]:
				r = reader.next()
				if not r["SAMPLING_EVENT_ID"] == row["SAMPLING_EVENT_ID"]:
					sys.exit("ID mismatch! Oh nose!")
				row.update(r)
			if row['PRIMARY_CHECKLIST_FLAG']:
				outrow["_id"] = row["SAMPLING_EVENT_ID"]
				del row["SAMPLING_EVENT_ID"]
				for key in row.keys():
					if "." in key:
						row[key.replace(".","_")] = row[key]
						del row[key]
				matched = False
				for key in species:
					if row[key] == "X":
						outrow[key] = uncounted_observation_replacement
						matched = True
					elif int(row[key]) > 0:
						outrow[key] = int(row[key])
						matched = True
				if matched:                     # If we found one of the species that we're looking for, we save the row.
					for key in num_metadata:
						if row[key] == "?":
							missing += 1
							outrow[key] = "?"
						else:
							outrow[key] = float(row[key])
					for key in cat_metadata:
						outrow[key] = row[key]
					if missing < missing_thresh * float(len(outrow)):
						data.insert(outrow)
						count += 1
					else:
						print "Skipped due to",missing,"missing records!"

		for file in files:
			file.close()

	ebird_metadata_setup(args.output, num_metadata+cat_metadata, species)